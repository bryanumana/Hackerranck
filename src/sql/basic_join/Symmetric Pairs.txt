You are given a table, Functions, containing two columns: X and Y.

| Column | Type    |
| X      | Integer |
| Y      | Integer |

Two pairs (X1, Y1) and (X2, Y2) are said to be symmetric pairs if X1 = Y2 and X2 = Y1.

Write a query to output all such symmetric pairs in ascending order by the value of X. List the rows such that X1 â‰¤ Y1.

SOLUTION:
WITH enumerate as(

SELECT
        X,
        Y,
        ROW_NUMBER() OVER(ORDER BY X,Y) AS rn
FROM    Functions f


        )

SELECT
        DISTINCT
        e.X,
        e.Y
FROM enumerate e

JOIN enumerate e2 ON e.X = e2.Y
AND e2.X = e.Y
AND e.rn <> e2.rn

WHERE e.X <= e.Y

ORDER BY X,Y